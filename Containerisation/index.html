<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Containerisation - Unofficial iRODS Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Containerisation";
        var mkdocs_page_input_path = "Containerisation.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Unofficial iRODS Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../About/">About</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Database</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Database_tuning/">Tuning</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developer</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Developer/">Brief overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../PythonAPI/">Python API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">System Administration</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Containerisation</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Sysadmin/">General Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Server_setup/">Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Queries/">Usefull Queries</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">User / Client notes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../User/">User Notes</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Unofficial iRODS Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>System Administration &raquo;</li>
      <li>Containerisation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="container-options">Container Options</h1>
<h1 id="docker">Docker</h1>
<h2 id="icommands-with-a-note-on-running-on-a-mac">icommands (with a note on running on a mac)</h2>
<p>Taken from the <a href="https://groups.google.com/d/msgid/irod-chat/ca981c1b-a09c-43a2-b654-6aab3abd8218n%40googlegroups.com?utm_medium=email&amp;utm_source=footer">iRODS-Chat</a> mailing list, authored by Terrell Russell from RENCI.</p>
<h3 id="start-a-container">start a container</h3>
<p>note the <code>platform</code> flag if you are on a Mac!</p>
<pre><code>docker run -d --platform linux/amd64 --name ub20icommands ubuntu:20.04 tail -f /dev/null
docker exec -it ub20icommands /bin/bash
</code></pre>
<p>then within the container, install the iCommands</p>
<pre><code>apt-get update
apt-get install -y wget sudo lsb-release gnupg
wget -qO - https://packages.irods.org/irods-signing-key.asc | sudo apt-key add -
echo &quot;deb [arch=amd64] https://packages.irods.org/apt/ $(lsb_release -sc) main&quot; | sudo tee /etc/apt/sources.list.d/renci-irods.list
apt-get update
apt-get install -y irods-icommands
</code></pre>
<p>then back on the host</p>
<pre><code>docker exec -it ub20icommands iinit
</code></pre>
<p>then the rest of the iCommands are available</p>
<p>``
$ docker exec -it ub20icommands ils
/tempZone/home/rods:</p>
<pre><code>
Note... putting and getting files are done from 'within' the container... so if you need to move data, you'll probably want to use a volume mount or `docker cp` to share between host and container.

</code></pre>
<p>$ docker cp filetoput.txt ub20icommands:/
$ docker exec -it ub20icommands iput filetoput.txt foo
$ docker exec -it ub20icommands ils
/tempZone/home/rods:
  foo</p>
<pre><code>



# Singularity

## icommands

Contributed by [leonardo](https://github.com/ll4strw);

</code></pre>
<h1 id="the-simplest-singularity-def-file-to-get-you-started-customise-appropriately">The simplest singularity def file to get you started. Customise appropriately</h1>
<h1 id="cat-icommandsdef">cat icommands.def</h1>
<p>Bootstrap: docker
From: centos:centos7</p>
<p>%post
    yum upgrade -y
    yum install -y wget epel-release
    yum install -y python36-jsonschema python36-psutil
    rpm --import https://packages.irods.org/irods-signing-key.asc
    wget -qO - https://packages.irods.org/renci-irods.yum.repo | tee /etc/yum.repos.d/renci-irods.yum.repo
    yum install -y irods-icommands.x86_64</p>
<p>%environment
    export LC_ALL=C</p>
<p>%runscript
    exec "$@"</p>
<h1 id="build-with">Build with</h1>
<h1 id="sudo-singularity-build-icommandssif-icommandsdef">sudo singularity build  icommands.sif icommands.def</h1>
<pre><code>
An example to deploy to an HPC environment that uses [Modules](http://modules.sourceforge.net/) with;

</code></pre>
<p>help([==[</p>
<h1 id="description">Description</h1>
<p>iRODS icommands v4.3.0.</p>
<h1 id="more-information">More information</h1>
<ul>
<li>Homepage: https://github.com/irods/irods_client_icommands
]==])</li>
</ul>
<p>conflict("icommands")
set_alias("iinit","/path/to/icommands.sif iinit")
set_alias("ils","/path/to/icommands.sif ils")</p>
<h1 id="add-other-icommands-in-a-similar-fashion-this-can-be-done-automatically-via">add other icommands in a similar fashion. This can be done automatically via</h1>
<p>ihelp | awk '$2=="-"{print "set_alias(\""$1"\",\"/path/to/icommands.sif "$1"\")"}' &gt;&gt; icommands/4.3.0.lua</p>
<h1 id="place-icommands430lua-in-an-appropriate-location-on-your-system">Place icommands/4.3.0.lua in an appropriate location on your system</h1>
<p>```</p>
<p>Some links for the above;</p>
<ul>
<li><a href="https://easybuild.io/">easybuild</a>
    EasyBuild is a software build and installation framework that allows you to manage (scientific) software on High Performance Computing (HPC) systems in an efficient way.</li>
<li><a href="https://lmod.readthedocs.io/en/latest/190_Integration_of_EasyBuild_and_Lmod.html">Lmod</a>;
    Lmod is a Lua based module system that easily handles the MODULEPATH Hierarchical problem. Environment Modules provide a convenient way to dynamically change the usersâ€™ environment through modulefiles. This includes easily adding or removing directories to the PATH environment variable. Modulefiles for Library packages provide environment variables that specify where the library and header files can be found.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../PythonAPI/" class="btn btn-neutral float-left" title="Python API"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Sysadmin/" class="btn btn-neutral float-right" title="General Notes">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../PythonAPI/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Sysadmin/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
